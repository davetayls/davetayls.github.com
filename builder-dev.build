<?xml version="1.0" encoding="utf-8"?>
<!--EXTERNAL_PROPERTIES: usdDatabaseVersion-->
<!--EXTERNAL_PROPERTIES: CCNetLabel-->
<project name="theTaylors" default="build" xmlns="http://nant.sf.net/release/0.85/nant.xsd">

  <property name="project.name" value="the-taylors" />
  <property name="solution.dir" value="${project::get-base-directory()}" />
  <property name="tools.dir" value="${solution.dir}/tools"/>
  <property name="trunk.dir" value="."/>
  <property name="company.name" value="Dave Taylor"/>
  <property name="build.dir" value="${solution.dir}\build"/>
  <property name="publish.dir" value="\\backroom\c$\the-taylors\"/>
  <property name="log.dir" value="${build.dir}\logs" />
  <property name="coverage.dir" value="${build.dir}\coverage" />
  <property name="nant.settings.currentframework" value="net-3.5" />
  <property name="version.major" value="0"/>
  <property name="version.minor" value="0"/>
  <property name="version.build" value="1"/>
  <property name="version.revision" value="0"/>
  <property name="project.fullversion" value="${version.major}.${version.minor}.${version.build}.${version.revision}" dynamic="true" />

  <!-- default configuration -->
  <property name="project.config" value="Debug" />

  <target name="build" depends="publish.xcopy" />

  <target name="init" description="Initializes build properties">
    <property name="build.dir" value="${build.dir}/${project.config}/"/>
    <mkdir dir="${build.dir}" />

    <echo message="Current Directory: ${project::get-base-directory()}"/>
	<echo message="Publish Directory: ${publish.dir}"/>
  </target>

  <target name="publish.xcopy" depends="init">

  <echo message="Deleting Publish Directory: ${publish.dir}"/>
  <!--Delete the old site-->
    <delete failonerror="true">
      <fileset basedir="${publish.dir}">
        <exclude name ="sitecore/**"/>
        <include name="**\*"/>
      </fileset>
    </delete>

	<echo message="Publishing Site to ${publish.dir}"/>
    <!--Publish the main site-->
    <copy todir="${publish.dir}" includeemptydirs="true" overwrite="true">
      <fileset basedir="${solution.dir}">
        <exclude name="**/obj/**"/>
        <exclude name="**/.svn/**"/>
        <exclude name="**/*.csproj"/>
        <exclude name="**/*.cs"/>
        <exclude name="**/*.csproj*"/>
        <exclude name="**/App_Data/**"/>
        <exclude name="**/Design.config*"/>
        <exclude name="**/Classes"/>
        <exclude name="**/Classes/**"/>
        <include name="**"/>
      </fileset>
    </copy>
  </target>

  <target name="clean" description="delete build artifacts">
    <delete dir="${build.dir}" failonerror="false" />
  </target>
  
  
  


  <target name="get-publishing-properties">
    <if test="${not property::exists('CCNetArtifactDirectory')}">
      <fail message="CCNetArtifactDirectory property not set, so can't create distribution files" />
    </if>

    <if test="${not property::exists('CCNetLabel')}">
      <fail message="CCNetLabel property not set, so can't create distribution files" />
    </if>

    <property name="project.fullversion" value="${CCNetLabel}" dynamic="true" />
    
  </target>



</project>
